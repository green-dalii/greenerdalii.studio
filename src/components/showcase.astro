---
import ContentSection from "./content-section.astro";
import ShowcaseCard from "../components/showcase-card.astro";
import Btn from "./button.astro";
import { Icon } from "astro-icon/components";
import sitesData from "../data/work/sites.json";
import type { ShowcaseSite } from "../types";

// ç›´æ¥ä½¿ç”¨æ‰€æœ‰é¡¹ç›®ï¼Œä¸ç­›é€‰isDisplayed
const allImages = import.meta.glob<ImageMetadata>("../data/work/images/*.{png,jpg,jpeg}", {
  eager: true,
  import: "default",
});

const sites = await Promise.all(
  sitesData.map(async (site) => {
    let _url = '../data/work' + site.image.substring(1)
    const image = await allImages[_url];
    return {
      ...site,
      image,
    };
  })
);

// ä¸ºäº†æ— é™æ»šåŠ¨æ•ˆæœï¼Œæˆ‘ä»¬éœ€è¦å¤åˆ¶é¡¹ç›®æ•°ç»„å¤šæ¬¡ç¡®ä¿æ— ç¼æ»šåŠ¨
const duplicatedSites = [...sites, ...sites, ...sites];
---

<section id="showcase" class="sm:py-30 w-full">
  <div
    class="container relative mx-auto flex flex-col sm:grid sm:grid-cols-5 py-32 sm:py-48 px-6 sm:px-5 max-w-7xl"
  >
    <div class="sm:col-span-2 md:col-span-3 -bottom-40 right-0.5 md:-bottom-0 md:right-1/2">
      <div class="mb-2 flex flex-col">
        <!-- <h2 class="title-font text-left font-black text-6xl sm:text-5xl">Greener-Dalii Studio</h2> -->
        <Icon name="wordmark" class="w-full sm:w-96 h-auto mb-2" />
        <h2 class="text-left font-bold text-2xl">
          æ ¼æ¶¦è¾¾ç†å·¥ä½œå®¤
        </h3>
      </div>
    </div>
    <div class="sm:col-start-3 sm:col-span-3 md:col-start-4 md:col-span-2">
      <div class="flex w-full flex-col text-left mt-10">
        <p class="break-words leading-loose text-sm">
          æˆ‘ä»¬è‡´åŠ›äºé€šè¿‡åˆ›æ„ä¸æŠ€æœ¯æ¥èåˆå•†ä¸šæ€§ã€è‰ºæœ¯æ€§å’Œç†æ€§æ„æ€
        </p>
        <p class="my-2 break-words leading-relaxed text-xs">
          We are committed to fusing commercial, artistic and rational ideas through creativity and technology.
        </p>
      </div>
    </div>
  </div>
  <div class="w-full px-0 py-12 sm:py-24">
    <div class="w-full space-y-2">
      <!-- æ— é™æ»šåŠ¨å®¹å™¨ -->
      <div class="overflow-hidden relative w-full">
        <div class="showcase-scroll flex gap-6 animate-scroll" style="width: max-content;">
          {duplicatedSites.map((site, index) => (
             <div class="flex-shrink-0 w-80 sm:w-96">
               <ShowcaseCard site={site} />
             </div>
           ))}
        </div>
      </div>
    </div>
    <div class="mt-10 text-center max-w-7xl mx-auto px-6">
      <Btn btnText="See More ğŸ‘€" btnAltText="çœ‹çœ‹æ›´å¤š ğŸ‘€" url="/work" cls="" />
    </div>
  </div>
</section>

<style>
  @keyframes scroll {
    0% {
      transform: translateX(0);
    }
    100% {
      transform: translateX(calc(-100% / 3));
    }
  }

  .animate-scroll {
    animation: scroll 45s linear infinite;
    will-change: transform;
  }

  .showcase-scroll:hover {
    animation-play-state: paused;
  }

  /* å“åº”å¼è°ƒæ•´ */
  @media (max-width: 640px) {
    .animate-scroll {
      animation-duration: 35s;
    }
  }

  @media (min-width: 1024px) {
    .animate-scroll {
      animation-duration: 50s;
    }
  }

  /* ç¡®ä¿æ»šåŠ¨å®¹å™¨ä¸ä¼šäº§ç”Ÿæ°´å¹³æ»šåŠ¨æ¡ */
  #showcase {
    overflow-x: hidden;
  }
</style>
